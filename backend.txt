abfrl-backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                  # ğŸš€ Application Entry Point
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                     # ğŸŒ Interface Layer (Routes)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ deps.py              # Dependency Injection (DB session, Current User)
â”‚   â”‚   â””â”€â”€ v1/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ api.py           # Router aggregator
â”‚   â”‚       â”œâ”€â”€ endpoints/
â”‚   â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚       â”‚   â”œâ”€â”€ chat.py      # Main Chat Endpoint (Web + Webhook)
â”‚   â”‚       â”‚   â”œâ”€â”€ products.py  # Product management
â”‚   â”‚       â”‚   â”œâ”€â”€ orders.py    # Order management
â”‚   â”‚       â”‚   â””â”€â”€ webhook.py   # Telegram/WhatsApp Webhook handler
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                    # âš™ï¸ Infrastructure Layer
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ config.py            # Environment variables (Pydantic Settings)
â”‚   â”‚   â”œâ”€â”€ security.py          # JWT Token logic
â”‚   â”‚   â””â”€â”€ exceptions.py        # Custom error handling
â”‚   â”‚
â”‚   â”œâ”€â”€ db/                      # ğŸ’¾ Database Layer
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ session.py           # Supabase/Postgres Engine connection
â”‚   â”‚   â””â”€â”€ base.py              # SQLAlchemy Base model
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                  # ğŸ—„ï¸ Database Tables (SQLAlchemy)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ user.py              # Users & Loyalty Points
â”‚   â”‚   â”œâ”€â”€ product.py           # Catalog & Inventory
â”‚   â”‚   â”œâ”€â”€ order.py             # Orders & OrderItems
â”‚   â”‚   â””â”€â”€ chat.py              # Conversation History & Session State
â”‚   â”‚
â”‚   â”œâ”€â”€ schemas/                 # ğŸ“ Pydantic Models (Data Validation)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ chat.py              # Request/Response schemas for LLM
â”‚   â”‚   â”œâ”€â”€ product.py
â”‚   â”‚   â””â”€â”€ order.py
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                # ğŸ› ï¸ Business Logic (The "Tools")
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ vector_store.py      # Qdrant/Pinecone Wrapper
â”‚   â”‚   â”œâ”€â”€ recommendation.py    # RAG Logic
â”‚   â”‚   â”œâ”€â”€ inventory.py         # Mock Inventory Logic
â”‚   â”‚   â”œâ”€â”€ payment.py           # Mock Payment Gateway
â”‚   â”‚   â””â”€â”€ fulfillment.py       # Delivery estimation logic
â”‚   â”‚
â”‚   â””â”€â”€ agents/                  # ğŸ§  AI Layer (LangGraph/Gemini)
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ master.py            # The Orchestrator (LangGraph StateGraph)
â”‚       â”œâ”€â”€ state.py             # AgentState definition (TypedDict)
â”‚       â”œâ”€â”€ prompts.py           # System Prompts for all agents
â”‚       â”œâ”€â”€ tools.py             # LangChain Tools wrapping /services
â”‚       â””â”€â”€ llm_client.py        # Gemini API Configuration
â”‚
â”œâ”€â”€ data/                        # ğŸ“„ Seed Data for Mocking
â”‚   â”œâ”€â”€ products_seed.json
â”‚   â”œâ”€â”€ inventory_seed.json
â”‚   â””â”€â”€ stores_seed.json
â”‚
â”œâ”€â”€ tests/                       # ğŸ§ª Testing
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_api.py
â”‚
â”œâ”€â”€ .env                         # Secrets (API Keys, DB URL)
â”œâ”€â”€ .gitignore
â”œâ”€â”€ docker-compose.yml           # For local DB/Vector DB
â”œâ”€â”€ Dockerfile                   # For deployment (Render)
â””â”€â”€ requirements.txt             # Dependencies